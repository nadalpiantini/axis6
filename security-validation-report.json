{
  "summary": {
    "score": 83,
    "status": "CRITICAL",
    "totalTests": 24,
    "passed": 19,
    "failed": 3,
    "warnings": 2,
    "critical": 3,
    "duration": 3624,
    "timestamp": "2025-09-07T18:50:24.416Z"
  },
  "tests": [
    {
      "name": "Database Security",
      "status": "FAIL",
      "message": "Database security test failed: supabaseUrl is required.",
      "severity": "critical",
      "timestamp": "2025-09-07T18:50:20.792Z"
    },
    {
      "name": "Auth Required: /api/checkins",
      "status": "PASS",
      "message": "Endpoint properly requires authentication",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:21.222Z"
    },
    {
      "name": "Auth Required: /api/analytics",
      "status": "PASS",
      "message": "Endpoint properly requires authentication",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:21.469Z"
    },
    {
      "name": "Auth Required: /api/streaks",
      "status": "PASS",
      "message": "Endpoint properly requires authentication",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:21.647Z"
    },
    {
      "name": "Auth Required: /api/settings/user-preferences",
      "status": "PASS",
      "message": "Endpoint properly requires authentication",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:22.164Z"
    },
    {
      "name": "CSRF Protection",
      "status": "PASS",
      "message": "POST requests require proper authentication/CSRF",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:22.286Z"
    },
    {
      "name": "Rate Limiting",
      "status": "WARN",
      "message": "Rate limiting may not be configured or limits are high",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.675Z"
    },
    {
      "name": "Header: content-security-policy",
      "status": "PASS",
      "message": "Present: default-src 'self'; script-src 'self' 'unsafe-inli...",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Header: x-frame-options",
      "status": "PASS",
      "message": "Present: DENY...",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Header: x-content-type-options",
      "status": "PASS",
      "message": "Present: nosniff...",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Header: x-xss-protection",
      "status": "PASS",
      "message": "Present: 1; mode=block...",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Header: referrer-policy",
      "status": "PASS",
      "message": "Present: strict-origin-when-cross-origin...",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Header: permissions-policy",
      "status": "PASS",
      "message": "Present: camera=(), microphone=(), geolocation=(), interest...",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "HSTS Header",
      "status": "PASS",
      "message": "HSTS properly configured",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "CSP Security",
      "status": "WARN",
      "message": "CSP allows unsafe-eval in production",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Environment Secrets",
      "status": "PASS",
      "message": "No obviously weak secrets detected",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Production Environment",
      "status": "FAIL",
      "message": "Missing production variables: CSRF_SECRET, SUPABASE_SERVICE_ROLE_KEY, UPSTASH_REDIS_REST_URL, UPSTASH_REDIS_REST_TOKEN",
      "severity": "critical",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "URL Configuration",
      "status": "PASS",
      "message": "App URL properly configured",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Authentication Security",
      "status": "FAIL",
      "message": "Auth security test failed: supabaseUrl is required.",
      "severity": "critical",
      "timestamp": "2025-09-07T18:50:23.806Z"
    },
    {
      "name": "Input Validation: XSS Script",
      "status": "PASS",
      "message": "Malicious input properly rejected",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:23.948Z"
    },
    {
      "name": "Input Validation: SQL Injection",
      "status": "PASS",
      "message": "Malicious input properly rejected",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:24.067Z"
    },
    {
      "name": "Input Validation: Path Traversal",
      "status": "PASS",
      "message": "Malicious input properly rejected",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:24.183Z"
    },
    {
      "name": "Input Validation: Null Byte",
      "status": "PASS",
      "message": "Malicious input properly rejected",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:24.297Z"
    },
    {
      "name": "Input Validation: Unicode Attack",
      "status": "PASS",
      "message": "Malicious input properly rejected",
      "severity": "normal",
      "timestamp": "2025-09-07T18:50:24.416Z"
    }
  ],
  "recommendations": [
    {
      "priority": "CRITICAL",
      "action": "Fix critical security issues immediately",
      "description": "Deploy RLS policies, add authentication to unprotected endpoints"
    },
    {
      "priority": "MEDIUM",
      "action": "Implement additional monitoring",
      "description": "Add security event monitoring and alerting"
    }
  ]
}